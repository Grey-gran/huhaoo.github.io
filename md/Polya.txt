---
title: Polya定理
date: 2019-02-19 09:35:23
tags:
- polya
- math
mathjax: on
---

<!--more-->

对于一个置换$p$，记循环个数为$c(p)$

那么用$m$种颜色染色本质不同方案数就是
$$
\dfrac{\sum_{p\in P}m^{c(p)}}{|P|}
$$
[例题](https://www.luogu.org/problemnew/show/P4980)

> 给定一个$n$个点，$n$条边的环，有$n$种颜色，给每个顶点染色，问有多少种**本质不同**的染色方案，答案对$10^9+7$取模

显然：
$$
n\times\mathrm{ans}=\sum_{i=0}^{n-1}n^{\gcd(n,i)}\\
=\sum_d\sum_{i=1}^{n}n^d[\gcd(n,i)=d]\\
=\sum_{d|n}n^d\sum_{i=1}^{\frac nd}[\gcd(\frac nd,i)=1]\\
=\sum_{d|n}n^d\mu(\frac nd)
$$
